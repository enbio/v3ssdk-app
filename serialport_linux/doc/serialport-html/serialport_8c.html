<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Serial Port: X:/serialport_linux/src/serialport.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Serial Port
   &#160;<span id="projectnumber">1.1 beta</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">serialport.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Some utils of the serial port, such as open the port, close the port and setup the port.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;termios.h&gt;</code><br/>
<code>#include &quot;error-log.h&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a71b3779d2bac44c47d9565369b5d0da1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialport_8c.html#a71b3779d2bac44c47d9565369b5d0da1">open_port</a> (const char *device)</td></tr>
<tr class="separator:a71b3779d2bac44c47d9565369b5d0da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b6e0a41bc0c4f7eaebca8c1013f195d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialport_8c.html#a6b6e0a41bc0c4f7eaebca8c1013f195d">close_port</a> (int fd)</td></tr>
<tr class="separator:a6b6e0a41bc0c4f7eaebca8c1013f195d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170c2cf25bef3fc9bb5ed960a3af019b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialport_8c.html#a170c2cf25bef3fc9bb5ed960a3af019b">setup_port</a> (int fd, int speed, int data_bits, int parity, int stop_bits)</td></tr>
<tr class="separator:a170c2cf25bef3fc9bb5ed960a3af019b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Some utils of the serial port, such as open the port, close the port and setup the port. </p>
<pre class="fragment">                 Copyleft (C) 2010  Late Lee
   This program is tested on LINUX PLATFORM, WITH GCC 4.x.
   The program is distributed in the hope that it will be
   useful, but WITHOUT ANY WARRANTY. Please feel free to 
   use the program, and I feel free to ignore the related
   issues. Any questions or suggestions, or bugs, please 
   contact me at
   &lt;$ echo -n "aHR0cDovL3d3dy5sYXRlbGVlLm9yZwo=" | base64 -d&gt;
   or e-mail to 
   &lt;$ echo -n "bGF0ZWxlZUAxNjMuY29tCg==" | base64 -d&gt;
   if you want to do this.
</pre><dl class="section author"><dt>Author</dt><dd>Late Lee </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Mon Jan 10 2011</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is a note. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This is a warning. </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>This is a bug. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>To do something. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6b6e0a41bc0c4f7eaebca8c1013f195d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int close_port </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>close_port - Close the port</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>: The file description returned by <a class="el" href="serialport_8c.html#a71b3779d2bac44c47d9565369b5d0da1">open_port()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if success, return -1 with some msg if error happens. </dd></dl>

</div>
</div>
<a class="anchor" id="a71b3779d2bac44c47d9565369b5d0da1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_port </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>open_port - Open a serial port</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>[in] : The serial port device name, eg, /dev/ttyS0</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return fd if success, otherwise will return -1 with some msg.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Each serial port on a UNIX system has one or more device files (files in the /dev directory) associated with it:</dd></dl>
<pre class="fragment">System         Port 1      Port 2
IRIX          /dev/ttyf1   /dev/ttyf2
HP-UX         /dev/tty1p0  /dev/tty2p0
Solaris/SunOS /dev/ttya    /dev/ttyb
Linux         /dev/ttyS0   /dev/ttyS1
Linux         /dev/ttyUSB0 /dev/ttyUSB1 (usb-serial converter)
Digital UNIX  /dev/tty01   /dev/tty02
(Windows       COM1        COM2)
</pre><p>We open the port specified by device name, for instance, if you want to open port 1, you just call the function like this: open_port("/dev/ttyS0"). </p>

</div>
</div>
<a class="anchor" id="a170c2cf25bef3fc9bb5ed960a3af019b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_port </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data_bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>parity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stop_bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>setup_port - Configure the port, eg. baud rate, data bits,etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>: The serial port </td></tr>
    <tr><td class="paramname">speed</td><td>: The baud rate </td></tr>
    <tr><td class="paramname">data_bits</td><td>: The data bits </td></tr>
    <tr><td class="paramname">parity</td><td>: The parity bits </td></tr>
    <tr><td class="paramname">stop_bits</td><td>: The stop bits</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if everything is OK, otherwise -1 with some error msg. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Here are termios structure members:</dd></dl>
<pre class="fragment">Member      Description 
c_cflag     Control options 
c_lflag     Line options 
c_iflag     Input options 
c_oflag     Output options 
c_cc        Control characters 
c_ispeed    Input baud (new interface) 
c_ospeed    Output baud (new interface) </pre><p> The c_cflag member controls the baud rate, number of data bits, parity, stop bits, and hardware flow control. There are constants for all of the supported configurations. Constant Description</p>
<pre class="fragment">CBAUD   Bit mask for baud rate 
B0      0 baud (drop DTR) 
B50     50 baud 
B75     75 baud 
B110    110 baud 
B134    134.5 baud 
B150    150 baud 
B200    200 baud 
B300    300 baud 
B600    600 baud 
B1200   1200 baud 
B1800   1800 baud 
B2400   2400 baud 
B4800   4800 baud 
B9600   9600 baud 
B19200  19200 baud 
B38400  38400 baud 
B57600  57,600 baud 
B76800  76,800 baud 
B115200 115,200 baud 
EXTA    External rate clock 
EXTB    External rate clock 
CSIZE   Bit mask for data bits 
CS5 5   data bits 
CS6 6   data bits 
CS7 7   data bits 
CS8 8   data bits 
CSTOPB  2 stop bits (1 otherwise) 
CREAD   Enable receiver 
PARENB  Enable parity bit 
PARODD  Use odd parity instead of even 
HUPCL   Hangup (drop DTR) on last close 
CLOCAL  Local line - do not change "owner" of port 
LOBLK   Block job control output 
CNEW_RTSCTS CRTSCTS     Enable hardware flow control (not supported on all 
                        platforms) </pre><p>The input modes member c_iflag controls any input processing that is done to characters received on the port. Like the c_cflag field, the final value stored in c_iflag is the bitwise OR of the desired options.</p>
<pre class="fragment">Constant        Description 
INPCK   Enable parity check 
IGNPAR  Ignore parity errors 
PARMRK  Mark parity errors 
ISTRIP  Strip parity bits 
IXON    Enable software flow control (outgoing) 
IXOFF   Enable software flow control (incoming) 
IXANY   Allow any character to start flow again 
IGNBRK  Ignore break condition 
BRKINT  Send a SIGINT when a break condition is detected 
INLCR   Map NL to CR 
IGNCR   Ignore CR 
ICRNL   Map CR to NL 
IUCLC   Map uppercase to lowercase 
IMAXBEL Echo BEL on input line too long 
</pre><p>Here are some examples of setting parity checking: <br/>
</p>
<p>No parity (8N1): </p>
<pre class="fragment">options.c_cflag &amp;= ~PARENB
options.c_cflag &amp;= ~CSTOPB
options.c_cflag &amp;= ~CSIZE;
options.c_cflag |= CS8;
</pre><p>Even parity (7E1): </p>
<pre class="fragment">options.c_cflag |= PARENB
options.c_cflag &amp;= ~PARODD
options.c_cflag &amp;= ~CSTOPB
options.c_cflag &amp;= ~CSIZE;
options.c_cflag |= CS7;
</pre><p>Odd parity (7O1): </p>
<pre class="fragment">options.c_cflag |= PARENB
options.c_cflag |= PARODD
options.c_cflag &amp;= ~CSTOPB
options.c_cflag &amp;= ~CSIZE;
options.c_cflag |= CS7;
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 8 2013 13:35:24 for Serial Port by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
